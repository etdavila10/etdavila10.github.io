---
import BaseLayout from '../layouts/BaseLayout.astro';

const title = 'Portfolio';
const pageTitle = 'Welcome';
const bgColor = 'bg-red-400';
---

<BaseLayout title={ title } pageTitle={ pageTitle } bgColor={ bgColor }>
  <div>
    <p class='text-2xl mb-5'>
      My name is
    </p>
    <div id='terminal-container' class='w-128 font-mono bg-slate-700 text-sky-500 flex justify-start items-center p-2 mb-10'>
      <span id='chevron-character' class='text-lime-500 text-4xl -translate-y-0.5'>❯</span>
      <span id='name-container' class='text-sky-500 text-4xl ml-2'></span>
      <span id='pipe-character' class='w-1 ml-1 rounded-full bg-sky-500 h-10 inline-block'></span>
    </div>
    <p class='text-2xl mb-5'>
      I am a
    </p>
    <div id='identity-container' class='cursor-pointer text-4xl rounded-full bg-sky-500 bg-opacity-20 w-fit p-5 border-2 border-sky-500 transition duration-200 hover:bg-opacity-50'>
    </div>
  </div>
</BaseLayout>

<script>
  const identifiers = ['Mathematician', 'Researcher', 'Algebraist', 'Programmer',
                       'Software Developer', 'Graduate Student', 'Teacher'];
  const fullName: string = 'Eduardo Torres Dávila';
  const nameContainer = document.getElementById('name-container')!;
  const pipeCharacter = document.getElementById('pipe-character')!;
  const identifierContainer = document.getElementById('identity-container')!;

  const animateName = () => {
    for (let i = 0; i < fullName.length; i++) {
      setTimeout(() => {
        nameContainer.innerHTML += fullName[i];
        if (i == fullName.length - 1) {
          setInterval(() => {
            if (pipeCharacter.classList.contains('hidden')) {
              pipeCharacter.classList.remove('hidden');
            } else {
              pipeCharacter.classList.add('hidden');
            }
          }, 500);
        };
      }, 200 * i);
    }
  };

  const renderIdentifier = () => {
    const randomIndex = Math.floor(Math.random() * identifiers.length);
    const randomIdentifier = identifiers[randomIndex];
    if (identifierContainer.innerHTML === randomIdentifier) {
      console.log('recalled');
      renderIdentifier();
    } else {
      identifierContainer.innerHTML = randomIdentifier;
    }
  };

  const funcsToRun = () => {
    renderIdentifier();
    animateName();
  };

  window.addEventListener("load",funcsToRun,false);
  identifierContainer.addEventListener('click', renderIdentifier);
</script>


