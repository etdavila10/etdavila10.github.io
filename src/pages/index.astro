---
import BaseLayout from '../layouts/BaseLayout.astro';

const title = 'Portfolio';
const pageTitle = 'Welcome';
---

<BaseLayout title={ title } pageTitle={ pageTitle }>
  <p class='text-2xl mb-5'>
    My name is
  </p>
  <div id='name-container' class='font-mono bg-slate-700 text-sky-500 text-4xl p-2 mb-10'>
  </div>
  <p class='text-2xl mb-5'>
    I am a
  </p>
  <div id='identity-container' class='cursor-pointer text-4xl rounded-full bg-sky-500 bg-opacity-20 w-fit p-5 border-2 border-sky-500 transition duration-200 hover:bg-opacity-50'>
  </div>
</BaseLayout>

<script>
  const identifiers = ['Mathematician', 'Researcher', 'Algebraist', 'Programmer',
                       'Software Developer', 'Graduate Student'];
  const fullName: string = 'Eduardo Torres Dávila';
  const nameContainer = document.getElementById('name-container')!;
  const identifierContainer = document.getElementById('identity-container')!;
  console.log(nameContainer.innerHTML);

  const animateName = () => {
    for (let i = 0; i < fullName.length; i++) {
      setTimeout(() => {
        const segment = fullName.slice(0, i+1);
        nameContainer.innerHTML = segment + '｜';
        if (i == fullName.length - 1) {
          setInterval(() => {
            let lastChar = nameContainer.innerHTML.slice(-1);
            if (lastChar === '｜') {
              nameContainer.innerHTML = nameContainer.innerHTML.slice(0, i+1);
            } else {
              nameContainer.innerHTML += '｜';
            }
          }, 500);
        };
      }, 100 * i);
    }
  };

  const renderIdentifier = () => {
    const randomIndex = Math.floor(Math.random() * identifiers.length);
    const randomIdentifier = identifiers[randomIndex];
    if (identifierContainer.innerHTML === randomIdentifier) {
      console.log('recalled');
      renderIdentifier();
    } else {
      identifierContainer.innerHTML = randomIdentifier;
    }
  };

  const funcsToRun = () => {
    renderIdentifier();
    animateName();
  };

  window.addEventListener("load",funcsToRun,false);
  identifierContainer.addEventListener('click', renderIdentifier);
</script>


